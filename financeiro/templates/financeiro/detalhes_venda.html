<!-- financeiro/detalhes_venda.html (Atualizado com foco em UX/UI: layout com grid responsivo, tabela de itens com hover, detalhes com ícones para melhor legibilidade. Lógica mantida.) -->

{% extends 'core/base.html' %}
{% load static %}
{% block content_title %}Detalhes da Venda{% endblock %}
{% block content %}
<div class="container-fluid" style="width: 100%; padding-right: 0; background: #f5f7fa; min-height: 100vh;">
  <div class="row mt-4">
    <div class="col-12">
      <div class="card border-0 shadow-lg" style="border-radius: 15px; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1); transition: transform 0.3s ease;">
        <div class="card-header bg-gradient text-black" style="background: linear-gradient(45deg, #dc3545, #e4606d); border-top-left-radius: 15px; border-top-right-radius: 15px; padding: 1.5rem;">
          <h4 class="m-0" style="font-size: 1.6rem; font-weight: 700; letter-spacing: 0.5px; display: flex; align-items: center;">
            <i class="bi bi-cart-check me-2"></i> Detalhes da Venda #{{ venda.id }}
          </h4>
        </div>
        <div class="card-body p-4" style="background: #ffffff; border-bottom-left-radius: 15px; border-bottom-right-radius: 15px;">
          <div class="row g-3">
            <div class="col-md-6">
              <p><i class="bi bi-person me-2"></i><strong>Cliente:</strong> {{ venda.cliente.nome|default:"Anônimo" }}</p>
              <p><i class="bi bi-calendar me-2"></i><strong>Data:</strong> {{ venda.data_venda|date:"d/m/Y H:i" }}</p>
              <p><i class="bi bi-credit-card me-2"></i><strong>Forma de Pagamento:</strong> {{ venda.get_forma_pagamento_display }}</p>
              <p><i class="bi bi-tags me-2"></i><strong>Desconto:</strong> R$ {{ venda.desconto|floatformat:2 }}</p>
              <p><i class="bi bi-wallet me-2"></i><strong>Total:</strong> R$ {{ venda.valor_total|floatformat:2 }}</p>
            </div>
          </div>
          <h5 class="mt-4">Itens da Venda</h5>
          <div class="table-responsive">
            <table class="table table-striped table-hover border rounded">
              <thead class="table-light">
                <tr>
                  <th>Produto</th>
                  <th>Quantidade</th>
                  <th>Valor Unitário (R$)</th>
                  <th>Subtotal (R$)</th>
                </tr>
              </thead>
              <tbody>
                {% for item in items %}
                <tr>
                  <td>{{ item.produto.nome }}</td>
                  <td>{{ item.quantidade }}</td>
                  <td>{{ item.produto.preco_venda|floatformat:2 }}</td>
                  <td>{{ item.subtotal|floatformat:2 }}</td>
                </tr>
                {% empty %}
                <tr>
                  <td colspan="4" class="text-center text-muted">Nenhum item na venda.</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <a href="{% url 'financeiro:historico_transacoes' %}" class="btn btn-secondary mt-3"><i class="bi bi-arrow-left"></i> Voltar</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block extra_scripts %}
<style>
  p { transition: all 0.3s; }
  p:hover { color: #dc3545; }
  @media (max-width: 768px) {
    .col-md-6 { flex: 0 0 100%; max-width: 100%; }
  }
</style>
{% endblock %}