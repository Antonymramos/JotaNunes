<!-- financeiro/historico_transacoes.html (Atualizado com foco em UX/UI: tabelas responsivas com scroll horizontal em mobile, linhas com hover e striped, botões com ícones e transições, colunas adicionais para pagamento/desconto. Lógica de listagem mantida.) -->

{% extends 'core/base.html' %}
{% load static %}
{% load mathfilters %}
{% block content_title %}Histórico de Transações{% endblock %}
{% block content %}
<div class="container-fluid" style="width: 100%; padding-right: 0; background: #f5f7fa; min-height: 100vh;">
  <!-- Seção de Vendas -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card border-0 shadow-lg" style="border-radius: 15px; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1); transition: transform 0.3s ease;">
        <div class="card-header bg-gradient d-flex justify-content-between align-items-center text-black" style="background: linear-gradient(45deg, #dc3545, #e4606d); border-top-left-radius: 15px; border-top-right-radius: 15px; padding: 1.5rem;">
          <h2 class="card-title m-0" style="font-size: 1.6rem; font-weight: 700; letter-spacing: 0.5px;">Vendas</h2>
          <a href="{% url 'financeiro:criar_venda' %}" class="btn btn-primary btn-sm" style="font-weight: 500; padding: 0.5rem 1rem; transition: all 0.3s ease;">
            <i class="bi bi-plus-circle me-1"></i> Nova Venda
          </a>
        </div>
        <div class="card-body p-4" style="background: #ffffff; border-bottom-left-radius: 15px; border-bottom-right-radius: 15px;">
          {% if vendas %}
          <div class="table-responsive">
            <table class="table table-striped table-hover border rounded">
              <thead class="table-light">
                <tr>
                  <th>ID</th>
                  <th>Cliente</th>
                  <th>Data</th>
                  <th>Forma de Pagamento</th>
                  <th>Desconto (R$)</th>
                  <th>Total (R$)</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody>
                {% for venda in vendas %}
                <tr>
                  <td>{{ venda.id }}</td>
                  <td>{{ venda.cliente }}</td>
                  <td>{{ venda.data|date:"d/m/Y H:i" }}</td>
                  <td>{{ venda.forma_pagamento }}</td>
                  <td>{{ venda.desconto|floatformat:2 }}</td>
                  <td>{{ venda.total|floatformat:2 }}</td>
                  <td>
                    <a href="{% url 'financeiro:detalhes_venda' venda.pk %}" class="btn btn-info btn-sm">
                      <i class="bi bi-eye"></i> Detalhes
                    </a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
              <tfoot>
                <tr>
                  <td colspan="5"><strong>Total Vendas</strong></td>
                  <td><strong>R$ {{ total_vendas|floatformat:2 }}</strong></td>
                  <td></td>
                </tr>
              </tfoot>
            </table>
          </div>
          {% else %}
          <p class="text-center text-muted">Nenhuma venda registrada.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Seção de Compras -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card border-0 shadow-lg" style="border-radius: 15px; box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1); transition: transform 0.3s ease;">
        <div class="card-header bg-gradient d-flex justify-content-between align-items-center text-black" style="background: linear-gradient(45deg, #dc3545, #e4606d); border-top-left-radius: 15px; border-top-right-radius: 15px; padding: 1.5rem;">
          <h2 class="card-title m-0" style="font-size: 1.6rem; font-weight: 700; letter-spacing: 0.5px;">Compras</h2>
          <a href="{% url 'financeiro:criar_compra' %}" class="btn btn-primary btn-sm" style="font-weight: 500; padding: 0.5rem 1rem; transition: all 0.3s ease;">
            <i class="bi bi-plus-circle me-1"></i> Nova Compra
          </a>
        </div>
        <div class="card-body p-4" style="background: #ffffff; border-bottom-left-radius: 15px; border-bottom-right-radius: 15px;">
          {% if compras %}
          <div class="table-responsive">
            <table class="table table-striped table-hover border rounded">
              <thead class="table-light">
                <tr>
                  <th>Ingrediente</th>
                  <th>Quantidade</th>
                  <th>Valor Unitário (R$)</th>
                  <th>Total (R$)</th>
                  <th>Data</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody>
                {% for compra in compras %}
                <tr>
                  <td>{{ compra.ingrediente }}</td>
                  <td>{{ compra.quantidade }}</td>
                  <td>{{ compra.valor_unitario|floatformat:2 }}</td>
                  <td>{{ compra.total|floatformat:2 }}</td>
                  <td>{{ compra.data|date:"d/m/Y H:i" }}</td>
                  <td>
                    <a href="{% url 'financeiro:detalhes_compra' compra.pk %}" class="btn btn-info btn-sm">
                      <i class="bi bi-eye"></i> Detalhes
                    </a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
              <tfoot>
                <tr>
                  <td colspan="3"><strong>Total Compras</strong></td>
                  <td><strong>R$ {{ total_compras|floatformat:2 }}</strong></td>
                  <td colspan="2"></td>
                </tr>
              </tfoot>
            </table>
          </div>
          {% else %}
          <p class="text-center text-muted">Nenhuma compra registrada.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block extra_scripts %}
<style>
  .table tr:hover { background-color: #f8f9fa; transition: background 0.3s; }
  .btn:hover { transform: translateY(-2px); }
  @media (max-width: 768px) {
    .card-header h2 { font-size: 1.4rem; }
    .table { font-size: 0.9rem; }
  }
</style>
{% endblock %}