{% extends 'core/base.html' %}
{% block content_title %}Listar Patrimônios{% endblock %}
{% block content %}
<div class="main-content">
  <div class="container-fluid px-2 sm:px-3 md:px-4 lg:px-5 py-3 sm:py-4">
    <div class="card border-0 shadow-sm" style="border-radius: 15px; max-width: 100%;">
      <div class="card-header bg-gradient d-flex justify-content-between align-items-center flex-column flex-sm-row" style="background: linear-gradient(45deg, #dc3545, #e4606d); border-top-left-radius: 15px; border-top-right-radius: 15px;">
        <h5 class="text-white m-0 mb-2 sm:mb-3 mb-sm-0" style="font-size: clamp(1rem, 3.5vw, 1.3rem); font-weight: 600;">Listar Patrimônios</h5>
        <div class="d-flex flex-column flex-sm-row gap-1 sm:gap-2">
          <a href="{% url 'patrimonios:gerar_relatorio_patrimonios' %}" class="btn btn-info btn-sm" style="color: #000; transition: all 0.3s ease; width: 100%; text-align: center;">
            <i class="bi bi-file-earmark-pdf"></i> Relatório
          </a>
          <a href="{% url 'patrimonios:criar_patrimonio' %}" class="btn btn-success btn-sm" style="color: #000; transition: all 0.3s ease; width: 100%; text-align: center;">
            <i class="bi bi-plus-circle"></i> Novo Patrimônio
          </a>
        </div>
      </div>
      <div class="card-body p-2 sm:p-3 md:p-4" style="background: #fff; border-bottom-left-radius: 15px; border-bottom-right-radius: 15px;">
        {% if messages %}
        <div class="alert alert-success alert-dismissible fade show mb-3 sm:mb-4" role="alert" style="color: #000; border-radius: 10px; font-size: clamp(0.75rem, 2.5vw, 1rem); font-weight: 400;">
          {% for message in messages %}
          {{ message }}
          {% endfor %}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endif %}
        {% if patrimonios %}
        <div class="table-responsive" style="overflow-x: auto;">
          <table class="table table-striped table-hover" style="color: #000; width: 100%;">
            <thead>
              <tr class="bg-light">
                <th style="font-size: clamp(0.75rem, 2.5vw, 1rem); font-weight: 500;">Nome</th>
                <th style="font-size: clamp(0.75rem, 2.5vw, 1rem); font-weight: 500;">Descrição</th>
                <th style="font-size: clamp(0.75rem, 2.5vw, 1rem); font-weight: 500;">Quantidade</th>
                <th style="font-size: clamp(0.75rem, 2.5vw, 1rem); font-weight: 500;">Valor Unitário</th>
                <th style="font-size: clamp(0.75rem, 2.5vw, 1rem); font-weight: 500;">Ações</th>
              </tr>
            </thead>
            <tbody>
              {% for patrimonio in patrimonios %}
              <tr>
                <td style="font-size: clamp(0.7rem, 2vw, 1rem); font-weight: 400;"><a href="{% url 'patrimonios:detalhar_patrimonio' patrimonio.id %}" class="text-decoration-none" style="color: #000;">{{ patrimonio.nome }}</a></td>
                <td style="font-size: clamp(0.7rem, 2vw, 1rem); font-weight: 400;">{{ patrimonio.descricao|default:"Sem descrição" }}</td>
                <td style="font-size: clamp(0.7rem, 2vw, 1rem); font-weight: 400;">{{ patrimonio.quantidade }}</td>
                <td style="font-size: clamp(0.7rem, 2vw, 1rem); font-weight: 400;">{{ patrimonio.valor_unitario }}</td>
                <td class="d-flex flex-column gap-1 sm:gap-2">
                  <a href="{% url 'patrimonios:detalhar_patrimonio' patrimonio.id %}" class="btn btn-primary btn-sm" style="color: #000; width: 100%;">
                    <i class="bi bi-eye"></i> Visualizar
                  </a>
                  <a href="{% url 'patrimonios:editar_patrimonio' patrimonio.id %}" class="btn btn-warning btn-sm" style="color: #000; width: 100%;">
                    <i class="bi bi-pencil"></i> Editar
                  </a>
                  <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal{{ patrimonio.id }}" style="color: #000; width: 100%;">
                    <i class="bi bi-trash"></i> Deletar
                  </button>
                </td>
              </tr>
              <div class="modal fade" id="deleteModal{{ patrimonio.id }}" tabindex="-1" aria-labelledby="deleteModalLabel{{ patrimonio.id }}" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-sm">
                  <div class="modal-content" style="border-radius: 15px;">
                    <div class="modal-header">
                      <h5 class="modal-title" id="deleteModalLabel{{ patrimonio.id }}" style="color: #000; font-size: clamp(0.9rem, 3vw, 1.2rem); font-weight: 600;">Confirmar Deleção</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="color: #000; font-size: clamp(0.75rem, 2.5vw, 1rem); font-weight: 400;">
                      Tem certeza que deseja deletar o patrimônio "{{ patrimonio.nome }}"?
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="color: #000; width: 100%;">Cancelar</button>
                      <form method="post" action="{% url 'patrimonios:excluir_patrimonio' patrimonio.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger" style="color: #000; width: 100%;">Deletar</button>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
        <p class="text-center text-muted" style="color: #000; font-size: clamp(0.75rem, 2.5vw, 1rem); font-weight: 400;">Nenhum patrimônio cadastrado.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block extra_scripts %}
<style>
  .btn-info:hover { background: linear-gradient(45deg, #138496, #17a2b8); transform: translateY(-2px); }
  .btn-success:hover { background: linear-gradient(45deg, #218838, #2eca5a); transform: translateY(-2px); }
  .btn-primary:hover { background: linear-gradient(45deg, #0a58ca, #3b82f6); transform: translateY(-2px); }
  .btn-warning:hover { background: linear-gradient(45deg, #e0a800, #ffca2c); transform: translateY(-2px); }
  .btn-danger:hover { background: linear-gradient(45deg, #b02a37, #c44d58); transform: translateY(-2px); }
  .main-content {
    margin-left: 250px;
    transition: margin-left 0.3s ease;
  }
  @media (max-width: 768px) {
    .main-content {
      margin-left: 0;
    }
    .table-responsive {
      overflow-x: auto;
    }
    .table thead th {
      font-size: clamp(0.7rem, 2vw, 0.85rem);
    }
    .table tbody td {
      font-size: clamp(0.65rem, 2vw, 0.8rem);
    }
    .card-body .btn {
      width: 100%;
      margin-bottom: 0.5rem;
      font-size: 0.75rem;
    }
    .modal-dialog {
      margin: 0.5rem;
      max-width: 90vw;
    }
  }
  @media (max-width: 576px) {
    .card-header h5 {
      font-size: clamp(0.9rem, 3vw, 1.2rem);
    }
    .card-body {
      padding: 0.75rem;
    }
    .btn-sm {
      font-size: clamp(0.65rem, 2vw, 0.8rem);
      padding: 0.4rem;
    }
  }
  @media (max-width: 320px) {
    .table {
      font-size: 0.7rem;
    }
    .modal-body {
      font-size: 0.75rem;
    }
  }
</style>
{% endblock %}